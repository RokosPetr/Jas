@page "{id:int}"
@model Jas.Areas.Ptg.Pages.PlateDetailModel
@{
    ViewData["Title"] = "Plátový stojan";
}

@section Styles {
    <link rel="stylesheet" href="~/css/ptg-plate-tag.min.css" />
}

<div class="container my-5 ptg-plate-detail">

    <div class="d-flex justify-content-between align-items-center mb-2">
        <h1 class="mb-0">@Model.Stand.Code - @Model.Stand.Name</h1>
        <button type="button"
                class="btn btn-sm btn-primary open-pdf-dialog"
                data-id="@Model.Stand.IdStand"
                data-has-pictures="true">
            Stáhnout PDF
        </button>
    </div>

    <!-- Thumbnaily plat (AJAX do #plate-content) -->
    <div class="d-flex flex-wrap justify-content-center gap-2 mt-2 mb-4">
        @for (int i = 0; i < Model.Plates.Count; i++)
        {
            var plate = Model.Plates[i];
            var isActive = (i + 1 == Model.Plate);
            var borderClass = isActive ? "border-primary border-3" : "border-secondary";

            <a asp-area="Ptg"
               asp-page="PlateDetail"
               asp-page-handler="Plate"
               asp-route-id="@Model.Stand!.IdStand"
               asp-route-plate="@(i + 1)"
               data-ajax="true"
               data-ajax-method="get"
               data-ajax-update="#plate-content"
               data-ajax-mode="replace"
               class="thumb"
               data-plate="@(i + 1)">
                <img src="@(string.IsNullOrEmpty(plate.ImgUrl) ? "/images/no-picture.png" : plate.ImgUrl)"
                     alt="Plato @(i + 1)"
                     class="img-thumbnail @borderClass"
                     style="height: 100px;" />
            </a>
        }
    </div>

    <!-- Sem se vkládá partial s obrázkem, tabulkou i TLAČÍTKY -->
    <div id="plate-content">

        @if (Model.InitialVm != null)
        {
            @await Html.PartialAsync("_PlateContent", Model.InitialVm)
        }

    </div>
</div>

<partial name="Shared/_PdfOptionsModal" />

@section Scripts {
    <script src="~/js/ptg/stand-detail.js" asp-append-version="true"></script>
    <script src="~/js/ptg-pdf-modal.js" asp-append-version="true"></script>
}
