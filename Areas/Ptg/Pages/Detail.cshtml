@page "{id:int}"
@model Jas.Areas.Ptg.Pages.DetailModel
@{
    ViewData["Title"] = "Detail stojanu";
}

@if (Model.Stand == null)
{
    <div class="alert alert-warning">Stojan nebyl nalezen.</div>
}
else
{
    <div class="container my-5">
        @if (Model.Plates.Any())
        {
            <div class="accordion" id="plateAccordion">
                @foreach (var plate in Model.Plates)
                {
                    var items = Model.PlateItems.Where(i => i.Id_Pt_Plate == plate.Id).ToList();
                    var plateId = $"plate_{plate.Id}";

                    <div class="accordion-item">
                        <h2 class="accordion-header" id="heading-@plateId">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-@plateId" aria-expanded="false" aria-controls="collapse-@plateId">
                                Plata @plate.Plate_Order - @plate.Description
                            </button>
                        </h2>
                        <div id="collapse-@plateId" class="accordion-collapse collapse" aria-labelledby="heading-@plateId" data-bs-parent="#plateAccordion">
                            <div class="accordion-body">
                                @if (items.Any())
                                {
                                    <table class="table table-sm table-bordered align-middle">
                                        <thead class="table-light">
                                            <tr>
                                                <th>#</th>
                                                <th>Název</th>
                                                <th>Rozměr</th>
                                                <th>Cena</th>
                                                <th>Jednotka</th>
                                                <th>Povrch</th>
                                                <th>Mrazuvzdornost</th>
                                                <th>Rektifikace</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (var item in items)
                                            {
                                                <tr>
                                                    <td>@item.Item_Order</td>
                                                    <td>@item.TagName</td>
                                                    <td>@item.Size</td>
                                                    <td>@(item.Price.HasValue ? item.Price.Value.ToString("N0") : "-")</td>
                                                    <td>@item.Unit</td>
                                                    <td>@item.Antislip</td>
                                                    <td>@(item.Frost ? "✓" : "×")</td>
                                                    <td>@(item.Rectification ? "✓" : "×")</td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                }
                                else
                                {
                                    <p class="text-muted">Žádné položky.</p>
                                }
                            </div>
                        </div>
                    </div>
                }
            </div>
        }
        else
        {
            <p class="text-muted">Stojan nemá žádné platy.</p>
        }
    </div>
}
